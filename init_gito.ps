Write-Host "===> 当前所在路径:"
pwd
Write-Host ""

Write-Host "===> Git 仓库检查 (.git 是否存在)"
if (!(Test-Path .git)) {
    Write-Host "⚠ 这里没有 .git 仓库！请先 cd 到你的仓库目录再运行这个脚本。"
    exit
}
Write-Host "OK，这里是一个 git 仓库。"
Write-Host ""

Write-Host "===> 拉取远程 main 分支最新内容"
git pull origin main
Write-Host ""

Write-Host "===> 工作区状态 (git status 之前)"
git status
Write-Host ""

Write-Host "===> 添加全部修改 (git add .)"
git add .
Write-Host ""

Write-Host "===> 再次查看状态 (git status 之后)"
git status
Write-Host ""

# 读取提交信息
$message = Read-Host "请输入这次提交说明(比如: 更新模型代码 / 新增公式推导 / 修复bug)"

if (-not $message -or $message.Trim() -eq "") {
    Write-Host "⚠ 没有输入提交说明，取消提交。请重新运行脚本并输入一段描述。"
    exit
}

Write-Host "===> 提交修改 (git commit)"
git commit -m $message
Write-Host ""

Write-Host "===> 推送到 GitHub (git push origin main)"
git push origin main
Write-Host ""

Write-Host "🎉 推送完成！请刷新 GitHub 仓库页面查看最新提交。"
git status